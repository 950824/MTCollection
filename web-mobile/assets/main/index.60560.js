window.__require=function e(t,n,o){function i(r,c){if(!n[r]){if(!t[r]){var s=r.split("/");if(s=s[s.length-1],!t[s]){var l="function"==typeof __require&&__require;if(!c&&l)return l(s,!0);if(a)return a(s,!0);throw new Error("Cannot find module '"+r+"'")}r=s}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){return i(t[r][1][e]||e)},u,u.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof __require&&__require,r=0;r<o.length;r++)i(o[r]);return i}({ADManager:[function(e,t,n){"use strict";cc._RF.push(t,"76b62yhTMJHw7hc2ZEHM2Eu","ADManager");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./DataManager"),c=e("./Enum"),s=e("./EventManager"),l=cc._decorator,u=l.ccclass,d=l.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.open=!1,t}return i(t,e),t.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),r.default.instance.adOpen=this.open,s.default.instance.on(c.GAME_EVENT_ENUM.PLAY_REWORD,this.showRewordAd,this)},t.prototype.start=function(){},t.prototype.showRewordAd=function(e){console.log("\u5c55\u793a\u6fc0\u52b1\u5e7f\u544a"),window.sheep_Android.ShowAD(e)},t.prototype.onDestroy=function(){s.default.instance.off(c.GAME_EVENT_ENUM.PLAY_REWORD,this.showRewordAd)},a([d("boolean")],t.prototype,"open",void 0),a([u],t)}(cc.Component);n.default=f,cc._RF.pop()},{"./DataManager":"DataManager","./Enum":"Enum","./EventManager":"EventManager"}],Block:[function(e,t,n){"use strict";cc._RF.push(t,"8ee63jWsghFjpPUaIi8jJ0G","Block");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./DataManager"),c=e("./Enum"),s=e("./EventManager"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.higherIds=[],t.lowerIds=[],t}return i(t,e),Object.defineProperty(t.prototype,"boardType",{get:function(){return this._boardType},set:function(e){this.boardType!=e&&(this._boardType=e,s.default.instance.emit(c.GAME_EVENT_ENUM.CHANGE_BOARD,this))},enumerable:!1,configurable:!0}),t.prototype.onLoad=function(){var e=cc.Node.EventType,t=e.TOUCH_START,n=e.TOUCH_CANCEL,o=e.TOUCH_END;this.node.on(t,this.onTouchstart,this),this.node.on(o,this.onTouchend,this),this.node.on(n,this.onTouchend,this)},t.prototype.init=function(e){Object.assign(this,e),r.default.instance.blocks.push(this),this.old_boardType=e.boardType,this.old_x=e.x,this.old_y=e.y,this.old_width=e.width,this.old_height=e.height,this.old_level=e.level,this.rendor()},t.prototype.rendor=function(){this.node.x=this.x,this.node.y=this.y,this.node.width=this.width,this.node.height=this.height,this.node.zIndex=this.level,this.node.getChildByName("label").getComponent(cc.Label).string=this.content,this.node.getChildByName("bg").active=!this.clickable(),this.node.getChildByName("bg").width=this.width,this.node.getChildByName("bg").height=this.height},t.prototype.clickable=function(){switch(this.boardType){case c.GAME_BOARD_ENUM.LEVEL:return!!r.default.instance.clickable||this.higherIds.length<=0;case c.GAME_BOARD_ENUM.RANDOM_LEFT:case c.GAME_BOARD_ENUM.RANDOM_RIGHT:return this.higherIds.length<=0;case c.GAME_BOARD_ENUM.LEVEL_EXTEND:return!0;default:return!1}},t.prototype.onTouchstart=function(e){if(r.default.instance.gameStatus==c.GAME_STATUS_ENUM.RUNING&&this.clickable()){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.SHOOT);var t=e.getLocation(),n=cc.find("Canvas").convertToNodeSpaceAR(t);s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_BROKEN,n),this.toSlot()}},t.prototype.toSlot=function(){var e=this;this.lowerIds.forEach(function(t){var n=r.default.instance.blocks.find(function(e){return e.id==t});n.higherIds.findIndex(function(t){return t==e.id})>=0&&n.higherIds.splice(n.higherIds.findIndex(function(t){return t==e.id}),1),n.rendor()}),-1==r.default.instance.records.findIndex(function(t){return t.id==e.id})&&r.default.instance.records.push(this),this.level=0,this.y=0,this.boardType=c.GAME_BOARD_ENUM.SLOT;var t=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.SLOT}),n=r.default.instance.blocks.filter(function(t){return t.content==e.content&&t.boardType==c.GAME_BOARD_ENUM.SLOT}),o=0;t.forEach(function(e){e.level>o&&(o=e.level)}),n.forEach(function(e){e.level=o+1,e.rendor()}),s.default.instance.emit(c.GAME_EVENT_ENUM.CHECK_CLEAR,this)},t.prototype.onTouchend=function(){},t.prototype.toSlotCancel=function(){var e=this;r.default.instance.blocks.filter(function(t){return e.lowerIds.includes(t.id)}).forEach(function(t){t.higherIds&&(t.higherIds.push(e.id),t.rendor())}),this.level=this.old_level,this.y=this.old_y,this.boardType=this.old_boardType,this.rendor()},t.prototype.onDestroy=function(){var e=cc.Node.EventType,t=e.TOUCH_START,n=e.TOUCH_CANCEL,o=e.TOUCH_END;this.node.off(t,this.onTouchstart),this.node.off(o,this.onTouchend),this.node.off(n,this.onTouchend)},a([u],t)}(cc.Component));n.default=d,cc._RF.pop()},{"./DataManager":"DataManager","./Enum":"Enum","./EventManager":"EventManager"}],BrokenManager:[function(e,t,n){"use strict";cc._RF.push(t,"51575OxGFxNYJBT4laQagbJ","BrokenManager");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Enum"),c=e("./EventManager"),s=e("./Utils"),l=cc._decorator,u=l.ccclass,d=l.property,f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.brokenPrefab=[],t}return i(t,e),t.prototype.onLoad=function(){c.default.instance.on(r.GAME_EVENT_ENUM.PLAY_BROKEN,this.onBrokenBuild,this)},t.prototype.onBrokenBuild=function(e){var t=new cc.Node;t.parent=this.node;for(var n=s.getRandom(2,4),o=0;o<n;o++){var i=o%4;if(this.brokenPrefab[i]){var a=cc.instantiate(this.brokenPrefab[i]);a.parent=t,e.x=e.x+o,e.y=e.y+o,a.setPosition(e);var r=s.getRandom(-200,200),c=0;o%2==0&&(c=s.getRandom(300,600)),o%2==1&&(c=s.getRandom(-300,-100)),a.getComponent("Broken").force(r,c)}}},t.prototype.onDestroy=function(){c.default.instance.off(r.GAME_EVENT_ENUM.PLAY_BROKEN,this.onBrokenBuild)},a([d([cc.Prefab])],t.prototype,"brokenPrefab",void 0),a([u],t)}(cc.Component);n.default=f,cc._RF.pop()},{"./Enum":"Enum","./EventManager":"EventManager","./Utils":"Utils"}],Broken:[function(e,t,n){"use strict";cc._RF.push(t,"f87ccwbUU1IqICcBj70zP9J","Broken");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=cc._decorator,c=r.ccclass,s=(r.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rb=null,t}return i(t,e),t.prototype.onLoad=function(){var e=this;this.rb=this.node.getComponent(cc.RigidBody),this.scheduleOnce(function(){e.node.parent&&e.node.parent.destroy()},5)},t.prototype.force=function(e,t){var n=this,o=this.rb.linearVelocity;this.scheduleOnce(function(){o.x=e,o.y=t,n.rb.linearVelocity=o})},a([c],t)}(cc.Component));n.default=s,cc._RF.pop()},{}],DataManager:[function(e,t,n){"use strict";cc._RF.push(t,"a70ebg49gZFg5JPPz7pnPgd","DataManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=e("./Enum"),i=function(){function e(){this._level=1,this.currentLevel=null,this.themeIndex=1,this.gameStatus=o.GAME_STATUS_ENUM.INIT,this.blocks=[],this.clickable=!1,this.records=[],this.adOpen=!1,this.extendnum=1,this.undbnum=1,this.shufflenum=1,this.clickablenum=1}return e.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(e,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e,this.save()},enumerable:!1,configurable:!0}),e.prototype.reset=function(){this.currentLevel=null,this.blocks=[],this.clickable=!1,this.records=[],this.gameStatus=o.GAME_STATUS_ENUM.INIT,this.extendnum=1,this.undbnum=1,this.shufflenum=1,this.clickablenum=1},e.prototype.save=function(){cc.sys.localStorage.setItem("SHEEP_STORAGE_KEY",JSON.stringify({level:this.level}))},e.prototype.restore=function(){var e=cc.sys.localStorage.getItem("SHEEP_STORAGE_KEY");try{var t=JSON.parse(e);this.level=(null==t?void 0:t.level)||1}catch(n){this.level=1,this.reset()}},e._instance=null,e}();n.default=i,cc._RF.pop()},{"./Enum":"Enum"}],Enum:[function(e,t,n){"use strict";cc._RF.push(t,"4bdb614jopGk4RHZxSXhA0n","Enum"),Object.defineProperty(n,"__esModule",{value:!0}),n.GAME_STATUS_ENUM=n.GAME_BOARD_ENUM=n.AUDIO_EFFECT_ENUM=n.GAME_EVENT_ENUM=n.GAME_SCENE_ENUM=void 0,function(e){e.MENU="Menu",e.GAME="Game"}(n.GAME_SCENE_ENUM||(n.GAME_SCENE_ENUM={})),function(e){e.PLAY_AUDIO="PLAY_AUDIO",e.CHANGE_BOARD="CHANGE_BOARD",e.PLAY_BROKEN="PLAY_BROKEN",e.CHECK_CLEAR="CHECK_CLEAR",e.CHECK_COMPLETE="CHECK_COMPLETE",e.CHECK_LOSED="CHECK_LOSED",e.PLAY_BOOM="PLAY_BOOM",e.PLAY_REWORD="PLAY_REWORD",e.REWORD_BACK="REWORD_BACK",e.PLAY_TOAST="PLAY_TOAST",e.SKILL_UPDATA="SKILL_UPDATA"}(n.GAME_EVENT_ENUM||(n.GAME_EVENT_ENUM={})),function(e){e[e.CLICK=0]="CLICK",e[e.CLEAR=1]="CLEAR",e[e.SHOOT=2]="SHOOT",e[e.LOSE=3]="LOSE",e[e.WIN=4]="WIN"}(n.AUDIO_EFFECT_ENUM||(n.AUDIO_EFFECT_ENUM={})),function(e){e.RANDOM_LEFT="RANDOM_LEFT",e.RANDOM_RIGHT="RANDOM_RIGHT",e.LEVEL="LEVEL",e.LEVEL_EXTEND="LEVEL_EXTEND",e.SLOT="SLOT",e.HIDE="HIDE"}(n.GAME_BOARD_ENUM||(n.GAME_BOARD_ENUM={})),function(e){e[e.INIT=0]="INIT",e[e.RUNING=1]="RUNING",e[e.CLEAR=2]="CLEAR",e[e.LOSED=3]="LOSED",e[e.COMPLETE=4]="COMPLETE"}(n.GAME_STATUS_ENUM||(n.GAME_STATUS_ENUM={})),cc._RF.pop()},{}],EventManager:[function(e,t,n){"use strict";cc._RF.push(t,"63d888t5qZGOIJjhBzWZoxj","EventManager"),Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(){this.eventMap=new Map}return e.getInstance=function(){return null===this._instance&&(this._instance=new this),this._instance},Object.defineProperty(e,"instance",{get:function(){return this.getInstance()},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t,n){this.eventMap.has(e)?this.eventMap.get(e).push({event:t,context:n}):this.eventMap.set(e,[{event:t,context:n}])},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(this.eventMap.has(e)){var o=this.eventMap.get(e);o.forEach(function(e){var n=e.event,o=e.context;o?n.apply(o,t):n(t)})}},e.prototype.off=function(e,t){if(this.eventMap.has(e)){var n=this.eventMap.get(e),o=n.findIndex(function(e){return e.event==t});o>-1&&n.splice(o,1)}},e.prototype.clear=function(){this.eventMap.clear()},e._instance=null,e}();n.default=o,cc._RF.pop()},{}],GameScene:[function(e,t,n){"use strict";cc._RF.push(t,"c13ecGsoNdJ664axM6NoZo1","GameScene");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./DataManager"),c=e("./Enum"),s=e("./EventManager"),l=e("./Levels"),u=e("./Utils"),d=cc._decorator,f=d.ccclass,h=d.property,E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.boardLevelNode=null,t.boardLevelExtendNode=null,t.boardRandomLeftNode=null,t.boardRandomRightNode=null,t.boardSlotNode=null,t.boardHideNode=null,t.titleLabel=null,t.blockPrefab=[],t.gameOverNode=null,t.gameCompleteNode=null,t.boom=null,t.extendNum=null,t.undbNum=null,t.shuffleNum=null,t.clickableNum=null,t}return i(t,e),t.prototype.onLoad=function(){cc.director.preloadScene(c.GAME_SCENE_ENUM.MENU);var e=cc.director.getPhysicsManager();e.enabled=!0,e.gravity=cc.v2(0,-640),s.default.instance.on(c.GAME_EVENT_ENUM.CHANGE_BOARD,this.onBoardChange,this),s.default.instance.on(c.GAME_EVENT_ENUM.CHECK_CLEAR,this.onClearCheck,this),s.default.instance.on(c.GAME_EVENT_ENUM.CHECK_COMPLETE,this.onCompleteCheck,this),s.default.instance.on(c.GAME_EVENT_ENUM.CHECK_LOSED,this.onLosedCheck,this),s.default.instance.on(c.GAME_EVENT_ENUM.PLAY_BOOM,this.onPlayBoom,this),s.default.instance.on(c.GAME_EVENT_ENUM.REWORD_BACK,this.onRewordBack,this),s.default.instance.on(c.GAME_EVENT_ENUM.SKILL_UPDATA,this.onSkillUpData,this),this.gameStart()},t.prototype.start=function(){},t.prototype.onBackMenu=function(){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),cc.director.loadScene(c.GAME_SCENE_ENUM.MENU)},t.prototype.gameStart=function(){r.default.instance.restore(),this.initGame(r.default.instance.level),r.default.instance.gameStatus=c.GAME_STATUS_ENUM.RUNING,s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA)},t.prototype.initGame=function(e){var t,n,o,i=this,a=l.Levels[e-1];if(!a){if(!l.Levels[0])return;e=1,r.default.instance.level=e,a=l.Levels[0]}this.clearNodeHistory(),r.default.instance.currentLevel=a,this.titleLabel.string=e+" Level";var s=a.clearableNum*a.blockTypeNum,d=a.leftRandomBlocks+a.rightRandomBlocks+a.levelNum*a.levelBlockNum;d%s!=0&&(d=(Math.floor(d/s)+1)*s);for(var f=[],h=[],E=a.blockContentArr.slice(0,a.blockTypeNum),p=0;p<d;p++)h.push(E[p%a.blockTypeNum]);for(h=u.shuffle(h),p=0;p<d;p++)f.push({id:p,x:null,y:null,width:3*a.chessItemWidth,height:3*a.chessItemHeight,level:0,boardType:null,content:h[p],higherIds:[],lowerIds:[]});var _=0;for(p=0;p<a.leftRandomBlocks;p++){(m=cc.instantiate(this.blockPrefab[r.default.instance.themeIndex])).setParent(this.boardRandomLeftNode),f[_].boardType=c.GAME_BOARD_ENUM.RANDOM_LEFT,f[_].x-=5*p,f[_].y=0,f[_].level-=p+10;for(var N=_-1;N>=0;)f[_].higherIds.push(N),N--;for(var M=_+1;M<a.leftRandomBlocks;)f[_].lowerIds.push(M),M++;m.getComponent("Block").init(f[_]),_++}for(p=0;p<a.rightRandomBlocks;p++){var m;for((m=cc.instantiate(this.blockPrefab[r.default.instance.themeIndex])).setParent(this.boardRandomRightNode),f[_].boardType=c.GAME_BOARD_ENUM.RANDOM_RIGHT,f[_].x+=5*p,f[_].y=0,f[_].level-=p+10,N=_-1;N>=a.leftRandomBlocks;)f[_].higherIds.push(N),N--;for(M=_+1;M<a.leftRandomBlocks+a.rightRandomBlocks;)f[_].lowerIds.push(M),M++;m.getComponent("Block").init(f[_]),_++}var A=!0;0==a.leftRandomBlocks&&0==a.rightRandomBlocks&&a.levelBlockNum%a.clearableNum==0&&a.levelNum*a.levelBlockNum%(a.clearableNum*a.blockTypeNum)==0&&a.levelBlockNum<=16&&(A=!1);var v=this.initChessBox(a.chessWidthNum,a.chessHeightNum),y=[],b=d-a.leftRandomBlocks-a.rightRandomBlocks,g=0,O=a.chessWidthNum-2,T=0,U=a.chessHeightNum-2;for(p=0;p<a.levelNum;p++){var C=Math.min(a.levelBlockNum,b);if(a.levelNum-1==p&&(C=b),a.blockBorderStep>0&&p>0)switch(p%4){case 0:g+=a.blockBorderStep;break;case 3:O-=a.blockBorderStep;break;case 2:T+=a.blockBorderStep;break;case 1:U-=a.blockBorderStep}var R=f.slice(_,_+C);_+=C;for(var L=new Set,D=0;D<R.length;D++){var S=R[D],k=void 0,G=void 0,I=void 0;if(A){if(I=(k=Math.floor(Math.random()*O+g))+"_"+(G=Math.floor(Math.random()*U+T)),L.has(I))for(;I=(k=Math.floor(Math.random()*O+g))+"_"+(G=Math.floor(Math.random()*U+T)),L.has(I););}else{var P=Math.floor(Math.sqrt(a.levelBlockNum));k=D%P*4+Math.floor((a.chessWidthNum-3*P)/2),P%2==0&&(k-=1),I=k+"_"+(G=5*Math.floor(D/P)+p)}null===(o=null===(n=null===(t=null==v?void 0:v[k])||void 0===t?void 0:t[G])||void 0===n?void 0:n.blocks)||void 0===o||o.push(S),L.add(I);for(var B=Math.max(k-2,0),w=Math.max(G-2,0),F=Math.min(k+3,a.chessWidthNum-2),j=Math.min(G+3,a.chessWidthNum-2),x=0,V=B;V<F;V++)for(var H=w;H<j;H++){var K=v[V][H].blocks;if(K.length>0){var Y=K[K.length-1];if(Y.id===S.id)continue;x=Math.max(x,Y.level),S.lowerIds.push(Y.id),Y.higherIds.push(S.id)}}S.boardType=c.GAME_BOARD_ENUM.LEVEL,S.x=k,S.y=G,S.level=x+1,S.x=k*a.chessItemWidth,S.y=G*a.chessItemHeight}if(y.push.apply(y,R),(b-=C)<=0)break}y.forEach(function(e){cc.instantiate(i.blockPrefab[r.default.instance.themeIndex]).getComponent("Block").init(e)});var W=a.slotNum*a.chessItemWidth*3+5*(a.slotNum+1);this.boardSlotNode.width=this.boardLevelExtendNode.width=W;var J=a.chessItemWidth*a.chessWidthNum/2*-1+a.chessWidthNum,q=a.chessItemHeight*a.chessHeightNum/2-85;this.boardLevelNode.setPosition(J,q)},t.prototype.clearNodeHistory=function(){this.boardLevelNode.removeAllChildren(),this.boardLevelExtendNode.removeAllChildren(),this.boardRandomLeftNode.removeAllChildren(),this.boardRandomRightNode.removeAllChildren(),this.boardSlotNode.removeAllChildren(),this.boardHideNode.removeAllChildren()},t.prototype.initChessBox=function(e,t){for(var n=new Array(e),o=0;o<e;o++){n[o]=new Array(t);for(var i=0;i<t;i++)n[o][i]={blocks:[]}}return n},t.prototype.onBoardChange=function(e){var t=this.boardLevelNode;e.boardType==c.GAME_BOARD_ENUM.SLOT&&(t=this.boardSlotNode),e.boardType==c.GAME_BOARD_ENUM.RANDOM_LEFT&&(t=this.boardRandomLeftNode),e.boardType==c.GAME_BOARD_ENUM.RANDOM_RIGHT&&(t=this.boardRandomRightNode),e.boardType==c.GAME_BOARD_ENUM.LEVEL_EXTEND&&(t=this.boardLevelExtendNode),e.boardType==c.GAME_BOARD_ENUM.HIDE&&(t=this.boardHideNode),e.node.setParent(t)},t.prototype.onClearCheck=function(e){var t=this,n=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.SLOT}),o=n.filter(function(t){return t.content==e.content});o.length>=r.default.instance.currentLevel.clearableNum?(r.default.instance.gameStatus=c.GAME_STATUS_ENUM.CLEAR,s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLEAR),o.forEach(function(e){r.default.instance.records.findIndex(function(t){return t.id==e.id})>=0&&r.default.instance.records.splice(r.default.instance.records.findIndex(function(t){return t.id==e.id}),1);var n=e.node.getComponent(cc.Animation);n.off("play",t.onClearPlay,e),n.on("play",t.onClearPlay,e),n.off("stop",t.onClearStop,e),n.on("stop",t.onClearStop,e),n.play()})):n.length>=r.default.instance.currentLevel.slotNum&&s.default.instance.emit(c.GAME_EVENT_ENUM.CHECK_LOSED,this)},t.prototype.onClearPlay=function(){this.node.getChildByName("label").active=!1,this.node.getChildByName("bg").active=!1},t.prototype.onClearStop=function(){this.node.getChildByName("label").active=!0,this.node.getChildByName("bg").active=!0,this.node.getComponent("Block").boardType=c.GAME_BOARD_ENUM.HIDE,r.default.instance.blocks.filter(function(e){return e.boardType!=c.GAME_BOARD_ENUM.HIDE}).length<=0?s.default.instance.emit(c.GAME_EVENT_ENUM.CHECK_COMPLETE,this):r.default.instance.gameStatus=c.GAME_STATUS_ENUM.RUNING},t.prototype.onCompleteCheck=function(){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.WIN),r.default.instance.gameStatus=c.GAME_STATUS_ENUM.COMPLETE,cc.find("Canvas/GameComplete/Panel/Restart").active=r.default.instance.level>=l.Levels.length,cc.find("Canvas/GameComplete/Panel/Next").active=r.default.instance.level<l.Levels.length,this.gameCompleteNode.active=!0},t.prototype.onGameReset=function(){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),this.gameOverNode.active=!1,this.gameCompleteNode.active=!1,r.default.instance.reset(),this.gameStart()},t.prototype.onGameNext=function(){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),this.gameCompleteNode.active=!1,this.gameOverNode.active=!1,r.default.instance.level+=1,r.default.instance.reset(),this.gameStart()},t.prototype.onLosedCheck=function(){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.LOSE),r.default.instance.gameStatus=c.GAME_STATUS_ENUM.LOSED,this.gameOverNode.active=!0},t.prototype.onPlayBoom=function(e){if(this.boom){this.boom.node.setPosition(e);var t=new cc.Color(u.getRandom(0,255),u.getRandom(0,255),u.getRandom(0,255),255);this.boom.startColor=this.boom.endColor=t,this.boom.resetSystem()}},t.prototype.onReword=function(e,t){if(r.default.instance.adOpen)switch(t){case"onGameExtend":r.default.instance.extendnum>0?this.onGameExtend():s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_REWORD,t);break;case"onGameUndo":r.default.instance.undbnum>0?this.onGameUndo():s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_REWORD,t);break;case"onGameShuffle":r.default.instance.shufflenum>0?this.onGameShuffle():s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_REWORD,t);break;case"onClickable":r.default.instance.clickablenum>0?this.onClickable():s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_REWORD,t)}else this[t]()},t.prototype.onGameExtend=function(){if(r.default.instance.gameStatus==c.GAME_STATUS_ENUM.RUNING){var e=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.SLOT});if(u.sort(e,"level"),!(e.length<=0)){var t=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.LEVEL_EXTEND});if(!(t.length>=r.default.instance.currentLevel.slotNum)){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK);for(var n=Math.min(3,r.default.instance.currentLevel.slotNum-t.length,e.length),o=0;o<n;o++)e[o].boardType=c.GAME_BOARD_ENUM.LEVEL_EXTEND,e[o].rendor();r.default.instance.extendnum-=1,s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA)}}}},t.prototype.onGameUndo=function(){if(r.default.instance.gameStatus==c.GAME_STATUS_ENUM.RUNING){var e=r.default.instance.records.pop();e&&(s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),e.toSlotCancel(),r.default.instance.undbnum-=1,s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA))}},t.prototype.onGameShuffle=function(){if(r.default.instance.gameStatus==c.GAME_STATUS_ENUM.RUNING){var e=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.LEVEL});if(!(e.length<=0)){s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK);var t=u.shuffle(u.pluck(e,"content")),n=0;e.forEach(function(e){e.content=t[n++],e.rendor()}),r.default.instance.shufflenum-=1,s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA)}}},t.prototype.onClickable=function(){if(r.default.instance.gameStatus==c.GAME_STATUS_ENUM.RUNING){var e=r.default.instance.blocks.filter(function(e){return e.boardType==c.GAME_BOARD_ENUM.LEVEL&&e.higherIds.length>0});e.length<=0||(s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),r.default.instance.clickable=!r.default.instance.clickable,e.forEach(function(e){e.node.getChildByName("bg").active=!r.default.instance.clickable}),r.default.instance.clickablenum-=1,s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA))}},t.prototype.onSkillUpData=function(){r.default.instance.extendnum>0?(this.extendNum.getComponent(cc.Label).string=r.default.instance.extendnum+"",this.extendNum.parent.active=!0):this.extendNum.parent.active=!1,r.default.instance.undbnum>0?(this.undbNum.getComponent(cc.Label).string=r.default.instance.undbnum+"",this.undbNum.parent.active=!0):this.undbNum.parent.active=!1,r.default.instance.shufflenum>0?(this.shuffleNum.getComponent(cc.Label).string=r.default.instance.shufflenum+"",this.shuffleNum.parent.active=!0):this.shuffleNum.parent.active=!1,r.default.instance.clickablenum>0?(this.clickableNum.getComponent(cc.Label).string=r.default.instance.clickablenum+"",this.clickableNum.parent.active=!0):this.clickableNum.parent.active=!1},t.prototype.onRewordBack=function(e){console.log("\u6fc0\u52b1\u5e7f\u544a\u56de\u8c03"+e.typeAd),e.status?s.default.instance.emit(c.GAME_EVENT_ENUM.SKILL_UPDATA):s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_TOAST,{msg:e.msg,seconds:2})},t.prototype.onDestroy=function(){s.default.instance.off(c.GAME_EVENT_ENUM.CHANGE_BOARD,this.onBoardChange),s.default.instance.off(c.GAME_EVENT_ENUM.CHECK_CLEAR,this.onClearCheck),s.default.instance.off(c.GAME_EVENT_ENUM.CHECK_COMPLETE,this.onCompleteCheck),s.default.instance.off(c.GAME_EVENT_ENUM.CHECK_LOSED,this.onLosedCheck),s.default.instance.off(c.GAME_EVENT_ENUM.PLAY_BOOM,this.onPlayBoom),s.default.instance.off(c.GAME_EVENT_ENUM.REWORD_BACK,this.onRewordBack),s.default.instance.off(c.GAME_EVENT_ENUM.SKILL_UPDATA,this.onSkillUpData)},a([h(cc.Node)],t.prototype,"boardLevelNode",void 0),a([h(cc.Node)],t.prototype,"boardLevelExtendNode",void 0),a([h(cc.Node)],t.prototype,"boardRandomLeftNode",void 0),a([h(cc.Node)],t.prototype,"boardRandomRightNode",void 0),a([h(cc.Node)],t.prototype,"boardSlotNode",void 0),a([h(cc.Node)],t.prototype,"boardHideNode",void 0),a([h(cc.Label)],t.prototype,"titleLabel",void 0),a([h([cc.Prefab])],t.prototype,"blockPrefab",void 0),a([h(cc.Node)],t.prototype,"gameOverNode",void 0),a([h(cc.Node)],t.prototype,"gameCompleteNode",void 0),a([h(cc.ParticleSystem)],t.prototype,"boom",void 0),a([h(cc.Node)],t.prototype,"extendNum",void 0),a([h(cc.Node)],t.prototype,"undbNum",void 0),a([h(cc.Node)],t.prototype,"shuffleNum",void 0),a([h(cc.Node)],t.prototype,"clickableNum",void 0),a([f],t)}(cc.Component);n.default=E,cc._RF.pop()},{"./DataManager":"DataManager","./Enum":"Enum","./EventManager":"EventManager","./Levels":"Levels","./Utils":"Utils"}],Levels:[function(e,t,n){"use strict";cc._RF.push(t,"925d3BeLCNK0KjXHdumnkyK","Levels"),Object.defineProperty(n,"__esModule",{value:!0}),n.Levels=void 0;var o=["\ud83e\udd80\ufe0f","\ud83e\udd9e","\ud83e\udd94","\ud83e\udd88","\ud83e\udd9d","\ud83e\udd89","\ud83e\udd8a","\ud83d\udc2d","\ud83d\udc17","\ud83d\udc36","\ud83d\udc31","\ud83d\udc3c","\ud83d\udc3b","\ud83d\udc30","\ud83e\udd81\ufe0f","\ud83d\udc38","\ud83d\udc37","\ud83d\udc3a","\ud83d\udc39","\ud83d\udc14","\ud83d\udc0c","\ud83d\udc1f","\ud83d\udc33","\ud83d\udc2c"];n.Levels=[{chessWidthNum:15,chessHeightNum:15,chessItemWidth:16,chessItemHeight:16,slotNum:7,clearableNum:3,leftRandomBlocks:0,rightRandomBlocks:0,levelNum:2,levelBlockNum:9,blockTypeNum:3,blockBorderStep:1,blockContentArr:o},{chessWidthNum:15,chessHeightNum:15,chessItemWidth:16,chessItemHeight:16,slotNum:7,clearableNum:3,leftRandomBlocks:4,rightRandomBlocks:4,levelNum:4,levelBlockNum:9,blockTypeNum:6,blockBorderStep:1,blockContentArr:o},{chessWidthNum:15,chessHeightNum:15,chessItemWidth:16,chessItemHeight:16,slotNum:7,clearableNum:3,leftRandomBlocks:6,rightRandomBlocks:6,levelNum:8,levelBlockNum:16,blockTypeNum:12,blockBorderStep:2,blockContentArr:o},{chessWidthNum:15,chessHeightNum:15,chessItemWidth:16,chessItemHeight:16,slotNum:7,clearableNum:3,leftRandomBlocks:8,rightRandomBlocks:8,levelNum:9,levelBlockNum:18,blockTypeNum:16,blockBorderStep:3,blockContentArr:o}],cc._RF.pop()},{}],MenuScene:[function(e,t,n){"use strict";cc._RF.push(t,"5a0cbRep8RGYIENIZ3ynqb8","MenuScene");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./DataManager"),c=e("./Enum"),s=e("./EventManager"),l=cc._decorator,u=l.ccclass,d=(l.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isNewSceneLoaded=!1,t}return i(t,e),t.prototype.onLoad=function(){var e=this;cc.debug.setDisplayStats(!1),cc.director.preloadScene(c.GAME_SCENE_ENUM.GAME,function(){},function(){e.isNewSceneLoaded=!0})},t.prototype.start=function(){},t.prototype.onStartGame=function(){this.isNewSceneLoaded&&(s.default.instance.emit(c.GAME_EVENT_ENUM.PLAY_AUDIO,c.AUDIO_EFFECT_ENUM.CLICK),r.default.instance.reset(),cc.director.loadScene(c.GAME_SCENE_ENUM.GAME))},a([u],t)}(cc.Component));n.default=d,cc._RF.pop()},{"./DataManager":"DataManager","./Enum":"Enum","./EventManager":"EventManager"}],MusicManager:[function(e,t,n){"use strict";cc._RF.push(t,"9770bSwZKxBao2f2APoKFGA","MusicManager");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Enum"),c=e("./EventManager"),s=cc._decorator,l=s.ccclass,u=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.click=null,t.clear=null,t.shoot=null,t.lose=null,t.win=null,t.bgm=null,t}return i(t,e),t.prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),c.default.instance.on(r.GAME_EVENT_ENUM.PLAY_AUDIO,this.onAudioPlay,this),cc.audioEngine.setMusicVolume(.8),cc.audioEngine.isMusicPlaying()||cc.audioEngine.playMusic(this.bgm,!0)},t.prototype.start=function(){},t.prototype.onAudioPlay=function(e){switch(e){case r.AUDIO_EFFECT_ENUM.CLICK:cc.audioEngine.playEffect(this.click,!1);break;case r.AUDIO_EFFECT_ENUM.CLEAR:cc.audioEngine.playEffect(this.clear,!1);break;case r.AUDIO_EFFECT_ENUM.SHOOT:cc.audioEngine.playEffect(this.shoot,!1);break;case r.AUDIO_EFFECT_ENUM.LOSE:cc.audioEngine.playEffect(this.lose,!1);break;case r.AUDIO_EFFECT_ENUM.WIN:cc.audioEngine.playEffect(this.win,!1)}},t.prototype.onDestroy=function(){c.default.instance.off(r.GAME_EVENT_ENUM.PLAY_AUDIO,this.onAudioPlay)},a([u(cc.AudioClip)],t.prototype,"click",void 0),a([u(cc.AudioClip)],t.prototype,"clear",void 0),a([u(cc.AudioClip)],t.prototype,"shoot",void 0),a([u(cc.AudioClip)],t.prototype,"lose",void 0),a([u(cc.AudioClip)],t.prototype,"win",void 0),a([u(cc.AudioClip)],t.prototype,"bgm",void 0),a([l],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./Enum":"Enum","./EventManager":"EventManager"}],ToastManager:[function(e,t,n){"use strict";cc._RF.push(t,"f26c7Dhz59O/rMI5OXvMK/6","ToastManager");var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=this&&this.__decorate||function(e,t,n,o){var i,a=arguments.length,r=a<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var c=e.length-1;c>=0;c--)(i=e[c])&&(r=(a<3?i(r):a>3?i(t,n,r):i(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r};Object.defineProperty(n,"__esModule",{value:!0});var r=e("./Enum"),c=e("./EventManager"),s=cc._decorator,l=s.ccclass,u=s.property,d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.msg=null,t}return i(t,e),t.prototype.onLoad=function(){c.default.instance.on(r.GAME_EVENT_ENUM.PLAY_TOAST,this.onShow,this),this.msg.active=!1},t.prototype.onShow=function(e){var t=this,n=e.msg,o=e.seconds;this.msg.active||(this.msg.getComponent(cc.Label).string=n,this.msg.active=!0,setTimeout(function(){t.msg.active=!1},1e3*o))},t.prototype.onDestroy=function(){c.default.instance.off(r.GAME_EVENT_ENUM.PLAY_TOAST,this.onShow)},a([u(cc.Node)],t.prototype,"msg",void 0),a([l],t)}(cc.Component);n.default=d,cc._RF.pop()},{"./Enum":"Enum","./EventManager":"EventManager"}],Utils:[function(e,t,n){"use strict";cc._RF.push(t,"a8e1fqRlcZB4aJbkFQh4UzV","Utils"),Object.defineProperty(n,"__esModule",{value:!0}),n.pluck=n.sort=n.getRandom=n.shuffle=void 0,n.shuffle=function(e){for(var t,n,o=e.length;o;)n=e[t=Math.floor(Math.random()*o--)],e[t]=e[o],e[o]=n;return e},n.getRandom=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},n.sort=function(e,t,n){return void 0===n&&(n=!0),e.sort(function(e,o){return e[t]>o[t]?n?1:-1:e[t]<o[t]?n?-1:1:0})},n.pluck=function(e,t){return e.map(function(e){return e[t]})},cc._RF.pop()},{}]},{},["ADManager","Block","Broken","BrokenManager","DataManager","Enum","EventManager","GameScene","Levels","MenuScene","MusicManager","ToastManager","Utils"]);